<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="PillPilot.Pages.DoseSchedulePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Dose Schedule"
    BackgroundColor="#071227">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Next Dose Header -->
            <Frame Padding="16" CornerRadius="14" BackgroundColor="{DynamicResource SecondaryContainer}">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Next Dose" FontSize="18" FontAttributes="Bold"/>
                    <Label Text="{Binding NextDoseText}" FontSize="16"/>
                    <Label Text="{Binding NextDoseTime}" FontSize="24" FontAttributes="Bold"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Daily Progress Bar -->
            <Frame Padding="16" CornerRadius="14" BackgroundColor="{DynamicResource SurfaceContainer}">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Daily Progress" FontSize="16" FontAttributes="Bold"/>
                    <ProgressBar Progress="{Binding DailyProgress}" HeightRequest="12" BackgroundColor="#E0E0E0"/>
                    <Label Text="{Binding DailyProgressText}" FontSize="12" HorizontalOptions="End"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Today's Dose List -->
            <VerticalStackLayout>
                <Label Text="Today's Doses" FontSize="18" FontAttributes="Bold" Margin="0,0,0,10" TextColor="White"/>
                <CollectionView ItemsSource="{Binding TodayDoses}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Padding="12" Margin="0,6" CornerRadius="12" BackgroundColor="{DynamicResource SurfaceContainerLow}">
                                <VerticalStackLayout Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                                        <!-- Dose Info -->
                                        <Label Text="{Binding Name}" FontSize="16" Grid.Row="0" Grid.Column="0"/>
                                        <Label Text="{Binding Time}" FontSize="16" FontAttributes="Bold" Grid.Row="0" Grid.Column="1"/>
                                        <Label Text="{Binding Status}" FontSize="12" TextColor="Gray" Grid.Row="1" Grid.ColumnSpan="2"/>
                                    </Grid>

                                    <!-- Quick Action Buttons -->
                                    <HorizontalStackLayout Spacing="12" HorizontalOptions="End">
                                        <Button Text="Take" Command="{Binding BindingContext.TakeDoseCommand, Source={x:Reference DoseSchedulePage}}" CommandParameter="{Binding .}"/>
                                        <Button Text="Snooze" Command="{Binding BindingContext.SnoozeDoseCommand, Source={x:Reference DoseSchedulePage}}" CommandParameter="{Binding .}"/>
                                        <Button Text="Skip" Command="{Binding BindingContext.SkipDoseCommand, Source={x:Reference DoseSchedulePage}}" CommandParameter="{Binding .}"/>
                                    </HorizontalStackLayout>
                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
